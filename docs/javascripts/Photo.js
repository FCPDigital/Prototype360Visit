function PhotoManager(t){this.mapManager=t,this.el=document.querySelector(".photo"),this.canvas=document.querySelector("#photo"),this.backBtn=document.querySelector(".photo__thumbnail-back"),this.sidebar=this.el.querySelector(".photo__sidebar"),this.sidebarBtn=this.el.querySelector(".photo__sidebar-close"),this.renderer=new THREE.WebGLRenderer({canvas:this.canvas}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e3),this.camera.lookAt(new THREE.Vector3(0,0,0)),this.initSphereMesh(),this.initParams(),this.camera.position.z=5;var e=this;this.backBtn.addEventListener("click",function(){this.mapManager.currentMap&&this.mapManager.currentMap.closePhoto()}.bind(this)),this.sidebarBtn.addEventListener("click",function(){e.sidebar.classList.toggle("photo__sidebar--display"),this.classList.toggle("photo__sidebar-close--reverse")}),document.addEventListener("resize",this.onDocumentResize.bind(this),!1),document.addEventListener("mousedown",this.onDocumentMouseDown.bind(this),!1),document.addEventListener("mousemove",this.onDocumentMouseMove.bind(this),!1),document.addEventListener("mouseup",this.onDocumentMouseUp.bind(this),!1)}PhotoManager.prototype={initSphereMesh:function(){this.geo=new THREE.SphereGeometry(40,32,32),this.material=new THREE.MeshBasicMaterial({side:THREE.BackSide}),this.sphereMesh=new THREE.Mesh(this.geo,this.material),this.sphereMesh.name="photo",this.scene.add(this.sphereMesh)},initParams:function(){this.savedX=0,this.savedY=0,this.lon=0,this.lat=0,this.savedLongitude=0,this.savedLatitude=0,this.bManualControl=!1},display:function(){this.renderer.setSize(window.innerWidth,window.innerHeight),setTimeout(function(){this.isDisplay=!0,this.el.classList.add("photo--display"),this.backBtn.classList.add("photo__thumbnail-back--display"),this.render(),this.sidebar.classList.add("photo__sidebar--display"),setTimeout(function(){this.mapManager.currentMap.currentMarker.unzoom(),this.mapManager.visiteBody.classList.add("visite__body--hide")}.bind(this),1e3)}.bind(this),1e3)},hide:function(){this.isDisplay=!1,this.sidebar.classList.remove("photo__sidebar--display"),this.sidebarBtn.classList.remove("photo__sidebar-close--reverse"),this.backBtn.classList.remove("photo__thumbnail-back--display"),setTimeout(function(){this.el.classList.remove("photo--display"),this.mapManager.visiteBody.classList.remove("visite__body--hide")}.bind(this),600)},onPhotoLoad:function(t){this.material.map=t,this.el.classList.remove("photo--loading"),this.display()},load:function(t){this.el.classList.add("photo--loading");(new THREE.TextureLoader).load(t.target,this.onPhotoLoad.bind(this))},render:function(){this.isDisplay&&requestAnimationFrame(this.render.bind(this)),this.autoRotate&&0==this.lonSpeed&&(this.lon+=.05),Math.abs(this.lonSpeed)>.5?this.lonSpeed*=.95:this.lonSpeed=0,this.lat=Math.max(-85,Math.min(85,this.lat));var t=new THREE.Vector3(500*Math.sin(THREE.Math.degToRad(90-this.lat))*Math.cos(THREE.Math.degToRad(this.lon)),500*Math.cos(THREE.Math.degToRad(90-this.lat)),500*Math.sin(THREE.Math.degToRad(90-this.lat))*Math.sin(THREE.Math.degToRad(this.lon)));this.camera.lookAt(t),this.renderer.render(this.scene,this.camera)},onDocumentMouseDown:function(t){t.preventDefault(),this.autoRotate=!1,this.bManualControl=!0,this.savedX=t.clientX,this.savedY=t.clientY,this.savedLongitude=this.lon,this.savedLatitude=this.lat},onDocumentMouseMove:function(t){this.bManualControl&&(this.lonSpeed=(this.savedX-t.clientX)/window.innerWidth*Math.PI*2*4,this.lon=.1*(this.savedX-t.clientX)+this.savedLongitude,this.lat=.1*(t.clientY-this.savedY)+this.savedLatitude)},onDocumentMouseUp:function(){this.bManualControl=!1,this.autoRotate=!0},onDocumentResize:function(){this.renderer.setSize(window.innerWidth,window.innerHeight)}};